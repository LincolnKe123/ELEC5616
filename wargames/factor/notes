Need some approach to this - too long for Magma
