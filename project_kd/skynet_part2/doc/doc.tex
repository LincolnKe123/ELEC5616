\title{\vspace{-5ex} \large Part 2 :: Protecting the Castle \\ \large (Commanding the Legion)\vspace{-2ex}}
\author{\large Dean Pisani 311210775 \\ \large Kristy Hughes 310186293\vspace{-2ex}}
\date{}

\documentclass[9pt,a4paper]{article}
\usepackage[top=0.6in,bottom=0.6in, left=0.6in, right=0.6in]{geometry}
\usepackage{listings}
\usepackage{color}
\usepackage{setspace}
\usepackage{amsmath}
\usepackage{sectsty}

\sectionfont{\fontsize{11}{9}\selectfont}

% Set up python syntax highlighting
\definecolor{Code}{rgb}{0,0,0}
\definecolor{Decorators}{rgb}{0.5,0.5,0.5}
\definecolor{Numbers}{rgb}{0.5,0,0}
\definecolor{MatchingBrackets}{rgb}{0.25,0.5,0.5}
\definecolor{Keywords}{rgb}{0,0,1}
\definecolor{self}{rgb}{0,0,0}
\definecolor{Strings}{rgb}{0,0.63,0}
\definecolor{Comments}{rgb}{0,0.63,0.2}
\definecolor{Backquotes}{rgb}{0,0,0}
\definecolor{Classname}{rgb}{0,0,0}
\definecolor{FunctionName}{rgb}{0,0,0}
\definecolor{Operators}{rgb}{0,0,0}
\definecolor{Background}{rgb}{0.98,0.98,0.98}

\lstnewenvironment{python}[1][]{
\lstset{
numbers=left,
numberstyle=\footnotesize,
numbersep=1em,
xleftmargin=1em,
framextopmargin=2em,
framexbottommargin=2em,
showspaces=false,
showtabs=false,
showstringspaces=false,
frame=l,
tabsize=4,
% Basic
basicstyle=\ttfamily\small\setstretch{1},
backgroundcolor=\color{Background},
language=Python,
% Comments
commentstyle=\color{Comments}\slshape,
% Strings
stringstyle=\color{Strings},
morecomment=[s][\color{Strings}]{"""}{"""},
morecomment=[s][\color{Strings}]{'''}{'''},
% keywords
morekeywords={import,from,class,def,for,while,if,is,in,elif,else,not,and,or,print,break,continue,return,True,False,None,access,as,,del,except,exec,finally,global,import,lambda,pass,print,raise,try,assert},
keywordstyle={\color{Keywords}\bfseries},
% additional keywords
morekeywords={[2]@invariant},
keywordstyle={[2]\color{Decorators}\slshape},
emph={self},
emphstyle={\color{self}\slshape},
%
}}{}

\begin{document}
\maketitle
\small
\setlength{\parindent}{0pt}

\section{Introduction to RSA}

\section{Authentication}
\emph{DONE}: How do you ensure the only one who can send updates to SkyNet is the botnet master?

Updates made to pastebot.net need to be signed by the master for them to be considered valid. We used asymmetric encryption using the RSA digital signature protocol with appendix according to PKCS\#1 PSS, which counters vulnerabilities introduced by using RSA encryption without proper cryptographic padding. The RSA keypair generated by the master is used for this signature, since the signatures make use of the master's private key. A bot then uses the master's public key which is made available to verify the signature. Only valid signatures are accepted by the bots, and since signatures can only be made with the private key the master holds, this ensures only the master can send updates to the bots. If an attacker were to attempt to create their own updates, or modify one in transit, then the signature will not be valid, since it has to be created using the private key combined with the original message.

\section{Confidentiality}
\emph{TODO}: How do you protect the valuable information to ensure it can only  be read by the botnet master? Remember that anyone can read the  information uploaded onto pastebot.net.

When bot's upload files to pastebot.net, they are encrypted using RSA. This takes the botnet master's public key. Thus, only somone in possession of the botnet master's RSA private key can decrypt these valuable documents

\begin{center}
\vspace{-2ex}
\begin{python}
def encrypt_for_master(data):
    # TODO: what does this line of code do?
    h=SHA.new(data)
    # Read in the master'spublic key
    key = RSA.importKey(open(os.path.join("pastebot.net", "master_rsa.pub")).read())
    # Create a cypher object with the key
    cipher = PKCS1_v1_5.new(key)
    # Encrypt the valuable data
    ciphertext = cipher.encrypt(data+h.digest())
    # Return encrypted data
    return ciphertext
\end{python}
\end{center}

\section{Integrity}

\emph{TODO}: How do you ensure the botnet updates signed by the botnet master cannot be forged or modifed?

\section{Replay Prevention}
TODO: something

\section{Breaking into Skynet}
\emph{TODO}: If SkyNet's botnet code is dismantled and/or the source code for it stolen, does your scheme become less secure?
If one of the bots were to be infiltrated, the attacker would not have access to any of the master's private data, since the bots only possess the master's public key. Thus, it would not give the attacker any means to disrupt the rest of the network, since they still cannot sign messages. They also cannot access any of the data uploaded by the other bots, since that also requires the private key. However they would have control over that particular bot, and could use it for their own means. Potentially they could use the public key to create fake information that will be still accepted by the master, giving them other means to attack. 

\emph{TODO}: Give an indication of how dismantledcult it would be for an adversary to take control of SkyNet when your protections are used.

\begin{center}
\vspace{-2ex}
\begin{python}
# TODO
\end{python}
\end{center}





\end{document}
